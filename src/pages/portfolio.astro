---
import BaseLayout from "@layouts/base-layout.astro";
import { siteConfig } from "@site-config";
import { getAllProjects } from "@utils/portfolio";

const sortedProjects = await getAllProjects(true, true);
---

<BaseLayout
  title={`Portfolio · ${siteConfig.siteTitle}`}
  description={`Welcome to my portfolio! I'm a senior ${siteConfig.jobTitle} specializing in modern web technologies. Explore my projects, skills, and professional experience in software development.`}
>
  <section>
    <header class="mb-8">
      <h1
        class="text-xl font-medium secondary mb-6 border-b border-gray-200 dark:border-gray-700 pb-2"
      >
        Portfolio
      </h1>
    </header>

    <div class="space-y-5">
      {
        sortedProjects.map((project) => (
          <article class="project-item border-b border-gray-200 dark:border-gray-700 pb-5">
            <div class="flex items-start justify-between gap-4 mb-2">
              <h3 class="text-base">
                <span class="secondary">{project.title}</span>
                {project.featured && (
                  <span class="text-yellow-400 ml-2 text-sm">★</span>
                )}
              </h3>
              <time class="text-xs text-gray-600 dark:text-gray-400 flex-shrink-0">
                {new Date(project.date).toLocaleDateString(siteConfig.locale, {
                  year: "numeric",
                  month: "short",
                })}
              </time>
            </div>

            <p class="text-xs text-gray-600 dark:text-gray-400 mb-3">
              {project.description}
            </p>

            <div class="flex flex-wrap gap-2 mb-3">
              {project.technologies.map((tech: string) => (
                <span class="text-xs text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">
                  {tech}
                </span>
              ))}
            </div>

            <div class="flex gap-4 text-sm">
              {project.github && (
                <a
                  href={project.github}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="primary-link"
                >
                  Code
                </a>
              )}
              {project.demo && (
                <a
                  href={project.demo}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="primary-link"
                >
                  Demo
                </a>
              )}
            </div>
          </article>
        ))
      }
    </div>

    {
      sortedProjects.length === 0 && (
        <p class="text-gray-600 dark:text-gray-400 text-sm">
          No projects available yet.
        </p>
      )
    }
  </section>
</BaseLayout>
